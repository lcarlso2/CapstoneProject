<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Downloads\College Work\CLASSES\Computing Capstone\CS4982CapstoneProject\code\RentMe\SharedCode\DAL\RentalDal.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;
using SharedCode.Model;

namespace SharedCode.DAL
{
	/// &lt;summary&gt;
	/// The rental dal responsible for communicating with the database for the rentals 
	/// &lt;/summary&gt;
	public class RentalDal : IRentalDal
	{


		/// &lt;summary&gt;
		/// Retrieves all borrowed items.
		/// &lt;/summary&gt;
		/// &lt;returns&gt;All borrowed items or an error if something goes wrong on the database&lt;/returns&gt;
        public List&lt;RentalItem&gt; RetrieveAllRentedItems()
        {
            var rentedItems = new List&lt;RentalItem&gt;();

            try
            {
                var conn = DbConnection.GetConnection();
                using (conn)
                {
                    conn.Open();
                    var query = &quot;select r.memberID, email, r.rentalID, r.rentalDateTime, &quot; +
                                &quot;r.returnDateTime, r.inventoryID, category, title, status from rental_transaction &quot; +
                                &quot;r, user, member, media, inventory_item i, status where &quot; +
                                &quot;userID = member.memberID and member.memberID = r.memberID and &quot; +
                                &quot;r.inventoryID = i.inventoryID and i.mediaID = media.mediaID and &quot; +
                                &quot;status.statusID = (select max(s1.statusID) from status_history s1 &quot; +
                                &quot;where r.rentalID = s1.rentalTransactionID &quot; +
                                &quot;group by s1.rentalTransactionID);&quot;;

                    using (var cmd = new MySqlCommand(query, conn))
                    {
                        using (var reader = cmd.ExecuteReader())
                        {
                            var memberIdOrdinal = reader.GetOrdinal(&quot;memberID&quot;);
                            var emailOrdinal = reader.GetOrdinal(&quot;email&quot;);
                            var rentalIdOrdinal = reader.GetOrdinal(&quot;rentalID&quot;);
                            var rentalDateOrdinal = reader.GetOrdinal(&quot;rentalDateTime&quot;);
                            var returnDateOrdinal = reader.GetOrdinal(&quot;returnDateTime&quot;);
                            var inventoryIdOrdinal = reader.GetOrdinal(&quot;inventoryID&quot;);
                            var categoryOrdinal = reader.GetOrdinal(&quot;category&quot;);
                            var titleOrdinal = reader.GetOrdinal(&quot;title&quot;);
                            var statusOrdinal = reader.GetOrdinal(&quot;status&quot;);





                            while (reader.Read())
                            {
                                var memberId = reader.GetInt32(memberIdOrdinal);

                                var memberEmail = reader[emailOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(emailOrdinal);

                                var rentalId = reader.GetInt32(rentalIdOrdinal);

                                var rentalDate = reader.GetDateTime(rentalDateOrdinal);

                                var returnDate = reader.GetDateTime(returnDateOrdinal);

                                var inventoryId = reader.GetInt32(inventoryIdOrdinal);

                                var category = reader[categoryOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(categoryOrdinal);

                                var title = reader[titleOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(titleOrdinal);

                                var status = reader[statusOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(statusOrdinal);



                                var item = new RentalItem
                                {
                                    MemberId = memberId,
                                    MemberEmail = memberEmail,
                                    RentalId = rentalId,
                                    RentalDate = rentalDate,
                                    ReturnDate = returnDate,
                                    InventoryId = inventoryId,
                                    Category = category,
                                    Title = title,
                                    Status = status,
                                    Condition = null
                                };

                                rentedItems.Add(item);
                            }
                        }
                    }
                    conn.Close();
                }

            }
            catch (Exception ex)
            {
                throw ex;
            }

            return rentedItems.OrderByDescending(item =&gt; item.RentalDate).ToList();
        }

        /// &lt;summary&gt;
        /// Retrieves all rentals with the given customer email
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;email&quot;&gt;the customer&#39;s email&lt;/param&gt;
        /// &lt;returns&gt;the list of rental items from the database rented by the given customer. Or an error if something goes wrong on the database&lt;/returns&gt;
        public List&lt;RentalItem&gt; RetrieveAllRentalsByCustomer(string email)
        {
            var rentedItems = new List&lt;RentalItem&gt;();

            try
            {
                var conn = DbConnection.GetConnection();
                using (conn)
                {
                    conn.Open();
                    var query = &quot;select r.memberID, email, r.rentalID, r.rentalDateTime, &quot; +
                                &quot;r.returnDateTime, r.inventoryID, category, title, status from rental_transaction &quot; +
                                &quot;r, user, member, media, inventory_item i, status where &quot; +
                                &quot;userID = member.memberID and member.memberID = r.memberID and &quot; +
                                &quot;r.inventoryID = i.inventoryID and i.mediaID = media.mediaID and &quot; +
                                &quot;status.statusID = (select max(s1.statusID) from status_history s1 &quot; +
                                &quot;where r.rentalID = s1.rentalTransactionID and r.memberId = (select memberID from member where email = @email) &quot; +
                                &quot;group by s1.rentalTransactionID);&quot;;

                    using (var cmd = new MySqlCommand(query, conn))
                    {
                        cmd.Parameters.AddWithValue(&quot;@email&quot;, email);

                        using (var reader = cmd.ExecuteReader())
                        {
                            var memberIdOrdinal = reader.GetOrdinal(&quot;memberID&quot;);
                            var emailOrdinal = reader.GetOrdinal(&quot;email&quot;);
                            var rentalIdOrdinal = reader.GetOrdinal(&quot;rentalID&quot;);
                            var rentalDateOrdinal = reader.GetOrdinal(&quot;rentalDateTime&quot;);
                            var returnDateOrdinal = reader.GetOrdinal(&quot;returnDateTime&quot;);
                            var inventoryIdOrdinal = reader.GetOrdinal(&quot;inventoryID&quot;);
                            var categoryOrdinal = reader.GetOrdinal(&quot;category&quot;);
                            var titleOrdinal = reader.GetOrdinal(&quot;title&quot;);
                            var statusOrdinal = reader.GetOrdinal(&quot;status&quot;);
                     

                            while (reader.Read())
                            {
                                var memberId = reader.GetInt32(memberIdOrdinal);

                                var memberEmail = reader[emailOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(emailOrdinal);

                                var rentalId = reader.GetInt32(rentalIdOrdinal);

                                var rentalDate = reader.GetDateTime(rentalDateOrdinal);

                                var returnDate = reader.GetDateTime(returnDateOrdinal);

                                var inventoryId = reader.GetInt32(inventoryIdOrdinal);

                                var category = reader[categoryOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(categoryOrdinal);

                                var title = reader[titleOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(titleOrdinal);

                                var status = reader[statusOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(statusOrdinal);



                                var item = new RentalItem
                                {
                                    MemberId = memberId,
                                    MemberEmail = memberEmail,
                                    RentalId = rentalId,
                                    RentalDate = rentalDate,
                                    ReturnDate = returnDate,
                                    InventoryId = inventoryId,
                                    Category = category,
                                    Title = title,
                                    Status = status
                                };

                                rentedItems.Add(item);
                            }
                        }
                    }

                    conn.Close();
                }

            }
            catch (Exception ex)
            {
                throw ex;
            }

            return rentedItems.OrderByDescending(item =&gt; item.RentalDate).ToList();
        }


        /// &lt;summary&gt;
        /// Retrieves select borrowed items with the given status.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;selectedStatus&quot;&gt; the desired status&lt;/param&gt;
        /// &lt;returns&gt;select borrowed items with the given status or an error if something goes wrong on the database&lt;/returns&gt;
        public List&lt;RentalItem&gt; RetrieveSelectRentedItems(string selectedStatus)
        {
            var rentedItems = new List&lt;RentalItem&gt;();

            try
            {
                var conn = DbConnection.GetConnection();
                using (conn)
                {
                    conn.Open();
                    var query = &quot;select r.memberID, email, r.rentalID, r.rentalDateTime, &quot; +
                                &quot;r.returnDateTime, r.inventoryID, category, title, status from rental_transaction &quot; +
                                &quot;r, user, member, media, inventory_item i, status where &quot; +
                                &quot;userID = member.memberID and member.memberID = r.memberID and &quot; +
                                &quot;r.inventoryID = i.inventoryID and i.mediaID = media.mediaID and status.status = @selectedStatus and &quot; +
                                &quot;status.statusID = (select max(s1.statusID) from status_history s1 &quot; +
                                &quot;where r.rentalID = s1.rentalTransactionID &quot; +
                                &quot;group by s1.rentalTransactionID);&quot;;

                    using (var cmd = new MySqlCommand(query, conn))
                    {

                        cmd.Parameters.AddWithValue(&quot;@selectedStatus&quot;, selectedStatus);

                        using (var reader = cmd.ExecuteReader())
                        {
                            var memberIdOrdinal = reader.GetOrdinal(&quot;memberID&quot;);
                            var emailOrdinal = reader.GetOrdinal(&quot;email&quot;);
                            var rentalIdOrdinal = reader.GetOrdinal(&quot;rentalID&quot;);
                            var rentalDateOrdinal = reader.GetOrdinal(&quot;rentalDateTime&quot;);
                            var returnDateOrdinal = reader.GetOrdinal(&quot;returnDateTime&quot;);
                            var inventoryIdOrdinal = reader.GetOrdinal(&quot;inventoryID&quot;);
                            var categoryOrdinal = reader.GetOrdinal(&quot;category&quot;);
                            var titleOrdinal = reader.GetOrdinal(&quot;title&quot;);
                            var statusOrdinal = reader.GetOrdinal(&quot;status&quot;);





                            while (reader.Read())
                            {
                                var memberId = reader.GetInt32(memberIdOrdinal);

                                var memberEmail = reader[emailOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(emailOrdinal);

                                var rentalId = reader.GetInt32(rentalIdOrdinal);

                                var rentalDate = reader.GetDateTime(rentalDateOrdinal);

                                var returnDate = reader.GetDateTime(returnDateOrdinal);

                                var inventoryId = reader.GetInt32(inventoryIdOrdinal);

                                var category = reader[categoryOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(categoryOrdinal);

                                var title = reader[titleOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(titleOrdinal);

                                var status = reader[statusOrdinal] == DBNull.Value
                                    ? &quot;null&quot;
                                    : reader.GetString(statusOrdinal);



                                var item = new RentalItem
                                {
                                    MemberId = memberId,
                                    MemberEmail = memberEmail,
                                    RentalId = rentalId,
                                    RentalDate = rentalDate,
                                    ReturnDate = returnDate,
                                    InventoryId = inventoryId,
                                    Category = category,
                                    Title = title,
                                    Status = status
                                };

                                rentedItems.Add(item);
                            }
                        }
                    }
                    conn.Close();
                }

            }
            catch (Exception ex)
            {
                throw ex;
            }

            return rentedItems.OrderByDescending(item =&gt; item.RentalDate).ToList();
        }

        /// &lt;summary&gt;
        /// Updates the status of the given rental
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;transactionId&quot;&gt;the rental transaction id&lt;/param&gt;
        /// &lt;param name=&quot;status&quot;&gt; the status &lt;/param&gt;
        /// &lt;param name=&quot;employeeId&quot;&gt;the employee updating the rental&lt;/param&gt;
        /// &lt;param name=&quot;condition&quot;&gt;the condition of the rental&lt;/param&gt;
        /// &lt;returns&gt;the rows affected or an error if something goes wrong on the database&lt;/returns&gt;
        public int UpdateStatus(int transactionId, string status, int employeeId, string condition)
        {

	        var rowsEffected = 0;

	        var statusId = RentalItem.GetStatusId(status);

	        try
	        {
		        var conn = DbConnection.GetConnection();
		        using (conn)
		        {
			        conn.Open();
			        using (var transaction = conn.BeginTransaction())
			        {
				        var query =
					        &quot;insert into status_history values (@transactionId, @statusID, @updateDateTime, @employeeID)&quot;;

				        using (var cmd = new MySqlCommand(query, conn))
				        {
					        cmd.Transaction = transaction;
					        cmd.Parameters.AddWithValue(&quot;@statusID&quot;, statusId);
					        cmd.Parameters.AddWithValue(&quot;@transactionId&quot;, transactionId);
					        cmd.Parameters.AddWithValue(&quot;@updateDateTime&quot;, DateTime.Now);
					        cmd.Parameters.AddWithValue(&quot;@employeeID&quot;, employeeId);

					        if (cmd.ExecuteNonQuery() != 1)
					        {
						        transaction.Rollback();
					        }

					        if (statusId == 2)
					        {

						        updateInventoryItemForShippedStatus(transactionId, cmd, transaction);
                                updateCondition(transactionId, cmd, transaction, condition);
					        }

					        if (statusId == 4)
					        {
						        insertIntoReturnConditionTable(transactionId, cmd, transaction, condition);
						        updateInventoryItemForReturnedStatus(transactionId, cmd, transaction,
							        condition);
					        }

					        transaction.Commit();

				        }
				        conn.Close();
			        }
		        }

	        }
	        catch (Exception ex)
	        {
		        throw ex;
	        }

	        return rowsEffected;
        }


        /// &lt;summary&gt;
        /// Gets the history for a specific rental transaction id
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;rentalId&quot;&gt; the desired rental id&lt;/param&gt;
        /// &lt;returns&gt;the history for the specific rental transaction or an error if something went wrong on the DB&lt;/returns&gt;
        public List&lt;RentalItem&gt; RetrieveHistoryForRentalTransaction(int rentalId)
        {
	        var rentalHistory = new List&lt;RentalItem&gt;();

            try
            {
                var conn = DbConnection.GetConnection();
                using (conn)
                {
                    conn.Open();
                    var query = &quot;select r.memberID, email, r.rentalID, r.rentalDateTime, r.returnDateTime, &quot; +
                                &quot;r.inventoryID, category, title, status, s2.updateDateTime from rental_transaction r, &quot; +
                                &quot;user, member, media, inventory_item i, status_history s2, status where userID = member.memberID &quot; +
                                &quot;and member.memberID = r.memberID and r.inventoryID = i.inventoryID and i.mediaID = media.mediaID &quot; +
                                &quot;and s2.rentalTransactionID = @rentalId and s2.rentalTransactionID = r.rentalID and s2.statusID = status.statusID&quot;;
                    using (var cmd = new MySqlCommand(query, conn))
                    {

	                    cmd.Parameters.AddWithValue(&quot;@rentalId&quot;, rentalId);

                        using (var reader = cmd.ExecuteReader())
                        {
                            var memberIdOrdinal = reader.GetOrdinal(&quot;memberID&quot;);
                            var emailOrdinal = reader.GetOrdinal(&quot;email&quot;);
                            var rentalIdOrdinal = reader.GetOrdinal(&quot;rentalID&quot;);
                            var rentalDateTimeOrdinal = reader.GetOrdinal(&quot;rentalDateTime&quot;);
                            var returnDateTimeOrdinal = reader.GetOrdinal(&quot;returnDateTime&quot;);
                            var inventoryIdOrdinal = reader.GetOrdinal(&quot;inventoryID&quot;);
                            var categoryOrdinal = reader.GetOrdinal(&quot;category&quot;);
                            var titleOrdinal = reader.GetOrdinal(&quot;title&quot;);
                            var statusOrdinal = reader.GetOrdinal(&quot;status&quot;);
                            var updateDateTimeOrdinal = reader.GetOrdinal(&quot;updateDateTime&quot;);

                            while (reader.Read())
                            {
                                var memberID = reader.GetInt32(memberIdOrdinal);
                                var email = reader[emailOrdinal] == DBNull.Value ? &quot;null&quot; : reader.GetString(emailOrdinal);
                                var rentalID = reader.GetInt32(rentalIdOrdinal);
                                var rentalDateTime = reader.GetDateTime(rentalDateTimeOrdinal);
                                var returnDateTime = reader.GetDateTime(returnDateTimeOrdinal);
                                var inventoryID = reader.GetInt32(inventoryIdOrdinal);
                                var category = reader[categoryOrdinal] == DBNull.Value ? &quot;null&quot; : reader.GetString(categoryOrdinal);
                                var title = reader[titleOrdinal] == DBNull.Value ? &quot;null&quot; : reader.GetString(titleOrdinal);
                                var status = reader[statusOrdinal] == DBNull.Value ? &quot;null&quot; : reader.GetString(statusOrdinal);
                                var updateDateTime = reader.GetDateTime(updateDateTimeOrdinal);


                                var rentalItem = new RentalItem
                                {
                                    MemberId = memberID,
                                    MemberEmail = email,
                                    RentalId = rentalID,
                                    RentalDate = rentalDateTime,
                                    ReturnDate = returnDateTime,
                                    InventoryId = inventoryID,
                                    Category = category,
                                    Title = title,
                                    Status = status,
                                    UpdateDateTime = updateDateTime
                                };

                                rentalHistory.Add(rentalItem);
                            }
                        }
                    }
                    conn.Close();
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }


            return rentalHistory.OrderByDescending(item =&gt; item.RentalDate).ThenByDescending(item =&gt; item.UpdateDateTime).ToList();

        }

        private static void updateCondition(int transactionId, MySqlCommand cmd,
	        MySqlTransaction transaction, string condition)
        {
	        cmd.Parameters.Clear();

	        cmd.CommandText =
		        &quot;update inventory_item set `condition` = @condition where inventoryID = (select inventoryID from rental_transaction where rentalID = @transactionId order by rentalID DESC limit 1);&quot;;
	        cmd.Parameters.AddWithValue(&quot;@transactionId&quot;, transactionId);
	        cmd.Parameters.AddWithValue(&quot;@condition&quot;, condition);


	        if (cmd.ExecuteNonQuery() != 1)
	        {
		        transaction.Rollback();
	        }
        }

        private static void updateInventoryItemForReturnedStatus(int transactionId, MySqlCommand cmd,
	        MySqlTransaction transaction, string condition)
        {
	       
	        cmd.Parameters.Clear();

	        cmd.CommandText =
			        &quot;update inventory_item set inStock = true, isRented = false, `condition` = @condition where inventoryID = (select inventoryID from rental_transaction where rentalID = @transactionId order by rentalID DESC limit 1);&quot;;
	        cmd.Parameters.AddWithValue(&quot;@transactionId&quot;, transactionId);
	        cmd.Parameters.AddWithValue(&quot;@condition&quot;, condition);


            if (cmd.ExecuteNonQuery() != 1) { 
		        transaction.Rollback();
	        }
        }

        private static void insertIntoReturnConditionTable(int transactionId, MySqlCommand cmd, MySqlTransaction transaction,
	        string condition)
        {
	        cmd.Parameters.Clear();

	        cmd.CommandText = &quot;insert into return_condition values (@rentalID, @condition, &quot; +
	                          &quot;(select `condition` from inventory_item, rental_transaction where &quot; +
	                          &quot;rental_transaction.rentalID = @rentalID and rental_transaction.inventoryID = inventory_item.inventoryID))&quot;;
	        cmd.Parameters.AddWithValue(&quot;@rentalID&quot;, transactionId);
	        cmd.Parameters.AddWithValue(&quot;@condition&quot;, condition);

	        if (cmd.ExecuteNonQuery() != 1)
	        {
		        transaction.Rollback();
	        }
        }

        private static void updateInventoryItemForShippedStatus(int transactionId, MySqlCommand cmd,
	        MySqlTransaction transaction)
        {
	        cmd.Parameters.Clear();

	        cmd.CommandText =
			        &quot;update inventory_item set inStock = false, isRented = true where inventoryID = (select inventoryID from rental_transaction where rentalID = @transactionId order by rentalID DESC limit 1);&quot;;
	        cmd.Parameters.AddWithValue(&quot;@transactionId&quot;, transactionId);


	        if (cmd.ExecuteNonQuery() != 1)
	        {
		        transaction.Rollback();
	        }
        }

        

    }

}

    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,22,10,0],[22,9,22,10,0],[22,9,22,10,1],[23,13,23,54,0],[23,13,23,54,0],[23,13,23,54,1],[26,13,26,14,0],[26,13,26,14,0],[26,13,26,14,1],[27,17,27,57,0],[27,17,27,57,1],[27,17,27,57,0],[28,17,28,29,1],[28,17,28,29,0],[28,17,28,29,0],[29,17,29,18,1],[29,17,29,18,0],[29,17,29,18,0],[30,21,30,33,1],[30,21,30,33,0],[30,21,30,33,0],[31,21,38,69,0],[31,21,38,69,0],[31,21,38,69,1],[40,28,40,67,0],[40,28,40,67,0],[40,28,40,67,1],[41,21,41,22,0],[41,21,41,22,0],[41,21,41,22,1],[42,32,42,64,0],[42,32,42,64,0],[42,32,42,64,1],[43,25,43,26,0],[43,25,43,26,1],[43,25,43,26,0],[44,29,44,81,1],[44,29,44,81,0],[44,29,44,81,0],[45,29,45,75,1],[45,29,45,75,0],[45,29,45,75,0],[46,29,46,81,1],[46,29,46,81,0],[46,29,46,81,0],[47,29,47,89,1],[47,29,47,89,0],[47,29,47,89,0],[48,29,48,89,0],[48,29,48,89,0],[48,29,48,89,1],[49,29,49,87,0],[49,29,49,87,1],[49,29,49,87,0],[50,29,50,81,0],[50,29,50,81,1],[50,29,50,81,0],[51,29,51,75,0],[51,29,51,75,1],[51,29,51,75,0],[52,29,52,77,0],[52,29,52,77,1],[52,29,52,77,0],[58,29,58,50,1],[58,29,58,50,0],[58,29,58,50,0],[59,29,59,30,1],[59,29,59,30,0],[59,29,59,30,0],[60,33,60,81,0],[60,33,60,81,1],[60,33,60,81,0],[62,33,64,70,0],[62,33,64,70,0],[62,33,64,70,1],[66,33,66,81,1],[66,33,66,81,0],[66,33,66,81,0],[68,33,68,88,0],[68,33,68,88,1],[68,33,68,88,0],[70,33,70,88,0],[70,33,70,88,0],[70,33,70,88,1],[72,33,72,87,0],[72,33,72,87,0],[72,33,72,87,1],[74,33,76,73,0],[74,33,76,73,1],[74,33,76,73,0],[78,33,80,70,0],[78,33,80,70,1],[78,33,80,70,0],[82,33,84,71,1],[82,33,84,71,0],[82,33,84,71,0],[88,33,100,35,0],[88,33,100,35,0],[88,33,100,35,1],[102,33,102,55,1],[102,33,102,55,0],[102,33,102,55,0],[103,29,103,30,1],[103,29,103,30,0],[103,29,103,30,0],[104,25,104,26,0],[104,25,104,26,0],[104,25,104,26,1],[105,21,105,22,0],[105,21,105,22,0],[105,21,105,22,1],[106,21,106,34,0],[106,21,106,34,0],[106,21,106,34,1],[107,17,107,18,0],[107,17,107,18,0],[107,17,107,18,1],[109,13,109,14,0],[109,13,109,14,0],[109,13,109,14,1],[110,13,110,33,0],[110,13,110,33,1],[110,13,110,33,0],[111,13,111,14,1],[111,13,111,14,0],[111,13,111,14,0],[112,17,112,26,1],[112,17,112,26,0],[112,17,112,26,0],[115,13,115,58,0],[115,58,115,73,0],[115,73,115,84,0],[115,13,115,84,0],[115,13,115,58,1],[115,58,115,73,1],[115,73,115,84,1],[115,13,115,84,1],[115,13,115,58,0],[115,58,115,73,0],[115,73,115,84,0],[115,13,115,84,0],[116,9,116,10,0],[116,9,116,10,1],[116,9,116,10,0],[124,9,124,10,0],[124,9,124,10,0],[124,9,124,10,1],[125,13,125,54,0],[125,13,125,54,0],[125,13,125,54,1],[128,13,128,14,0],[128,13,128,14,1],[128,13,128,14,0],[129,17,129,57,1],[129,17,129,57,0],[129,17,129,57,0],[130,17,130,29,0],[130,17,130,29,1],[130,17,130,29,0],[131,17,131,18,0],[131,17,131,18,0],[131,17,131,18,1],[132,21,132,33,0],[132,21,132,33,0],[132,21,132,33,1],[133,21,140,69,1],[133,21,140,69,0],[133,21,140,69,0],[142,28,142,67,0],[142,28,142,67,0],[142,28,142,67,1],[143,21,143,22,0],[143,21,143,22,0],[143,21,143,22,1],[144,25,144,70,1],[144,25,144,70,0],[144,25,144,70,0],[146,32,146,64,1],[146,32,146,64,0],[146,32,146,64,0],[147,25,147,26,1],[147,25,147,26,0],[147,25,147,26,0],[148,29,148,81,0],[148,29,148,81,1],[148,29,148,81,0],[149,29,149,75,0],[149,29,149,75,0],[149,29,149,75,1],[150,29,150,81,0],[150,29,150,81,1],[150,29,150,81,0],[151,29,151,89,0],[151,29,151,89,0],[151,29,151,89,1],[152,29,152,89,1],[152,29,152,89,0],[152,29,152,89,0],[153,29,153,87,0],[153,29,153,87,1],[153,29,153,87,0],[154,29,154,81,0],[154,29,154,81,1],[154,29,154,81,0],[155,29,155,75,1],[155,29,155,75,0],[155,29,155,75,0],[156,29,156,77,0],[156,29,156,77,1],[156,29,156,77,0],[159,29,159,50,0],[159,29,159,50,1],[159,29,159,50,0],[160,29,160,30,0],[160,29,160,30,0],[160,29,160,30,0],[161,33,161,81,0],[161,33,161,81,0],[161,33,161,81,0],[163,33,165,70,0],[163,33,165,70,0],[163,33,165,70,0],[167,33,167,81,0],[167,33,167,81,0],[167,33,167,81,0],[169,33,169,88,0],[169,33,169,88,0],[169,33,169,88,0],[171,33,171,88,0],[171,33,171,88,0],[171,33,171,88,0],[173,33,173,87,0],[173,33,173,87,0],[173,33,173,87,0],[175,33,177,73,0],[175,33,177,73,0],[175,33,177,73,0],[179,33,181,70,0],[179,33,181,70,0],[179,33,181,70,0],[183,33,185,71,0],[183,33,185,71,0],[183,33,185,71,0],[189,33,200,35,0],[189,33,200,35,0],[189,33,200,35,0],[202,33,202,55,0],[202,33,202,55,0],[202,33,202,55,0],[203,29,203,30,0],[203,29,203,30,0],[203,29,203,30,0],[204,25,204,26,0],[204,25,204,26,1],[204,25,204,26,0],[205,21,205,22,1],[205,21,205,22,0],[205,21,205,22,0],[207,21,207,34,1],[207,21,207,34,0],[207,21,207,34,0],[208,17,208,18,1],[208,17,208,18,0],[208,17,208,18,0],[210,13,210,14,0],[210,13,210,14,0],[210,13,210,14,1],[211,13,211,33,0],[211,13,211,33,1],[211,13,211,33,0],[212,13,212,14,0],[212,13,212,14,1],[212,13,212,14,0],[213,17,213,26,0],[213,17,213,26,1],[213,17,213,26,0],[216,13,216,58,1],[216,58,216,73,0],[216,73,216,84,1],[216,13,216,84,1],[216,13,216,58,0],[216,58,216,73,0],[216,73,216,84,0],[216,13,216,84,0],[216,13,216,58,0],[216,58,216,73,0],[216,73,216,84,0],[216,13,216,84,0],[217,9,217,10,0],[217,9,217,10,0],[217,9,217,10,1],[226,9,226,10,0],[226,9,226,10,0],[226,9,226,10,1],[227,13,227,54,0],[227,13,227,54,0],[227,13,227,54,1],[230,13,230,14,0],[230,13,230,14,1],[230,13,230,14,0],[231,17,231,57,1],[231,17,231,57,0],[231,17,231,57,0],[232,17,232,29,1],[232,17,232,29,0],[232,17,232,29,0],[233,17,233,18,1],[233,17,233,18,0],[233,17,233,18,0],[234,21,234,33,0],[234,21,234,33,0],[234,21,234,33,1],[235,21,242,69,0],[235,21,242,69,1],[235,21,242,69,0],[244,28,244,67,0],[244,28,244,67,1],[244,28,244,67,0],[245,21,245,22,0],[245,21,245,22,1],[245,21,245,22,0],[247,25,247,88,0],[247,25,247,88,0],[247,25,247,88,1],[249,32,249,64,0],[249,32,249,64,0],[249,32,249,64,1],[250,25,250,26,0],[250,25,250,26,0],[250,25,250,26,1],[251,29,251,81,0],[251,29,251,81,1],[251,29,251,81,0],[252,29,252,75,1],[252,29,252,75,0],[252,29,252,75,0],[253,29,253,81,0],[253,29,253,81,0],[253,29,253,81,1],[254,29,254,89,1],[254,29,254,89,0],[254,29,254,89,0],[255,29,255,89,0],[255,29,255,89,0],[255,29,255,89,1],[256,29,256,87,1],[256,29,256,87,0],[256,29,256,87,0],[257,29,257,81,0],[257,29,257,81,0],[257,29,257,81,1],[258,29,258,75,0],[258,29,258,75,1],[258,29,258,75,0],[259,29,259,77,1],[259,29,259,77,0],[259,29,259,77,0],[265,29,265,50,1],[265,29,265,50,0],[265,29,265,50,0],[266,29,266,30,0],[266,29,266,30,0],[266,29,266,30,1],[267,33,267,81,0],[267,33,267,81,0],[267,33,267,81,1],[269,33,271,70,0],[269,33,271,70,0],[269,33,271,70,1],[273,33,273,81,0],[273,33,273,81,0],[273,33,273,81,1],[275,33,275,88,0],[275,33,275,88,1],[275,33,275,88,0],[277,33,277,88,1],[277,33,277,88,0],[277,33,277,88,0],[279,33,279,87,1],[279,33,279,87,0],[279,33,279,87,0],[281,33,283,73,1],[281,33,283,73,0],[281,33,283,73,0],[285,33,287,70,1],[285,33,287,70,0],[285,33,287,70,0],[289,33,291,71,0],[289,33,291,71,0],[289,33,291,71,1],[295,33,306,35,0],[295,33,306,35,1],[295,33,306,35,0],[308,33,308,55,0],[308,33,308,55,1],[308,33,308,55,0],[309,29,309,30,0],[309,29,309,30,0],[309,29,309,30,1],[310,25,310,26,0],[310,25,310,26,0],[310,25,310,26,1],[311,21,311,22,0],[311,21,311,22,0],[311,21,311,22,1],[312,21,312,34,0],[312,21,312,34,0],[312,21,312,34,1],[313,17,313,18,0],[313,17,313,18,1],[313,17,313,18,0],[315,13,315,14,1],[315,13,315,14,0],[315,13,315,14,0],[316,13,316,33,1],[316,13,316,33,0],[316,13,316,33,0],[317,13,317,14,1],[317,13,317,14,0],[317,13,317,14,0],[318,17,318,26,0],[318,17,318,26,1],[318,17,318,26,0],[321,13,321,58,0],[321,58,321,73,0],[321,73,321,84,0],[321,13,321,84,0],[321,13,321,58,1],[321,58,321,73,1],[321,73,321,84,1],[321,13,321,84,1],[321,13,321,58,0],[321,58,321,73,0],[321,73,321,84,0],[321,13,321,84,0],[322,9,322,10,0],[322,9,322,10,1],[322,9,322,10,0],[333,9,333,10,0],[333,9,333,10,1],[333,9,333,10,0],[335,10,335,31,1],[335,10,335,31,0],[335,10,335,31,0],[337,10,337,56,0],[337,10,337,56,0],[337,10,337,56,1],[340,10,340,11,0],[340,10,340,11,0],[340,10,340,11,1],[341,11,341,51,0],[341,11,341,51,0],[341,11,341,51,1],[342,11,342,23,0],[342,11,342,23,1],[342,11,342,23,0],[343,11,343,12,1],[343,11,343,12,0],[343,11,343,12,0],[344,12,344,24,1],[344,12,344,24,0],[344,12,344,24,0],[345,19,345,60,1],[345,19,345,60,0],[345,19,345,60,0],[346,12,346,13,0],[346,12,346,13,0],[346,12,346,13,1],[347,13,348,108,0],[347,13,348,108,1],[347,13,348,108,0],[350,20,350,59,0],[350,20,350,59,1],[350,20,350,59,0],[351,13,351,14,0],[351,13,351,14,1],[351,13,351,14,0],[352,14,352,44,1],[352,14,352,44,0],[352,14,352,44,0],[353,14,353,65,0],[353,14,353,65,0],[353,14,353,65,1],[354,14,354,75,0],[354,14,354,75,0],[354,14,354,75,1],[355,14,355,75,0],[355,14,355,75,0],[355,14,355,75,1],[356,14,356,69,0],[356,14,356,69,0],[356,14,356,69,1],[358,14,358,45,0],[358,14,358,45,1],[358,14,358,45,0],[359,14,359,15,0],[359,14,359,15,0],[359,14,359,15,0],[360,15,360,38,0],[360,15,360,38,0],[360,15,360,38,0],[361,14,361,15,0],[361,14,361,15,0],[361,14,361,15,0],[363,14,363,32,1],[363,14,363,32,0],[363,14,363,32,0],[364,14,364,15,0],[364,14,364,15,1],[364,14,364,15,0],[366,15,366,84,0],[366,15,366,84,1],[366,15,366,84,0],[367,33,367,93,0],[367,33,367,93,1],[367,33,367,93,0],[368,14,368,15,1],[368,14,368,15,0],[368,14,368,15,0],[370,14,370,32,0],[370,14,370,32,0],[370,14,370,32,1],[371,14,371,15,0],[371,14,371,15,0],[371,14,371,15,1],[372,15,372,90,0],[372,15,372,90,0],[372,15,372,90,1],[373,15,374,27,0],[373,15,374,27,1],[373,15,374,27,0],[375,14,375,15,1],[375,14,375,15,0],[375,14,375,15,0],[377,14,377,35,1],[377,14,377,35,0],[377,14,377,35,0],[379,13,379,14,1],[379,13,379,14,0],[379,13,379,14,0],[380,13,380,26,1],[380,13,380,26,0],[380,13,380,26,0],[381,12,381,13,0],[381,12,381,13,0],[381,12,381,13,1],[382,11,382,12,0],[382,11,382,12,1],[382,11,382,12,0],[384,10,384,11,0],[384,10,384,11,1],[384,10,384,11,0],[385,10,385,30,0],[385,10,385,30,0],[385,10,385,30,0],[386,10,386,11,0],[386,10,386,11,0],[386,10,386,11,0],[387,11,387,20,0],[387,11,387,20,0],[387,11,387,20,0],[390,10,390,30,0],[390,10,390,30,0],[390,10,390,30,1],[391,9,391,10,0],[391,9,391,10,0],[391,9,391,10,1],[400,9,400,10,0],[400,9,400,10,1],[400,9,400,10,0],[401,10,401,53,1],[401,10,401,53,0],[401,10,401,53,0],[404,13,404,14,1],[404,13,404,14,0],[404,13,404,14,0],[405,17,405,57,1],[405,17,405,57,0],[405,17,405,57,0],[406,17,406,29,0],[406,17,406,29,0],[406,17,406,29,1],[407,17,407,18,0],[407,17,407,18,1],[407,17,407,18,0],[408,21,408,33,0],[408,21,408,33,1],[408,21,408,33,0],[409,21,413,148,0],[409,21,413,148,1],[409,21,413,148,0],[414,28,414,67,1],[414,28,414,67,0],[414,28,414,67,0],[415,21,415,22,0],[415,21,415,22,0],[415,21,415,22,1],[417,22,417,73,0],[417,22,417,73,0],[417,22,417,73,1],[419,32,419,64,0],[419,32,419,64,0],[419,32,419,64,1],[420,25,420,26,0],[420,25,420,26,1],[420,25,420,26,0],[421,29,421,81,1],[421,29,421,81,0],[421,29,421,81,0],[422,29,422,75,1],[422,29,422,75,0],[422,29,422,75,0],[423,29,423,81,1],[423,29,423,81,0],[423,29,423,81,0],[424,29,424,93,0],[424,29,424,93,0],[424,29,424,93,1],[425,29,425,93,0],[425,29,425,93,1],[425,29,425,93,0],[426,29,426,87,0],[426,29,426,87,1],[426,29,426,87,0],[427,29,427,81,0],[427,29,427,81,1],[427,29,427,81,0],[428,29,428,75,1],[428,29,428,75,0],[428,29,428,75,0],[429,29,429,77,0],[429,29,429,77,0],[429,29,429,77,1],[430,29,430,93,0],[430,29,430,93,0],[430,29,430,93,1],[432,29,432,50,0],[432,29,432,50,0],[432,29,432,50,1],[433,29,433,30,0],[433,29,433,30,1],[433,29,433,30,0],[434,33,434,81,0],[434,33,434,81,1],[434,33,434,81,0],[435,33,435,124,0],[435,33,435,124,1],[435,33,435,124,0],[436,33,436,81,0],[436,33,436,81,0],[436,33,436,81,1],[437,33,437,96,1],[437,33,437,96,0],[437,33,437,96,0],[438,33,438,96,0],[438,33,438,96,1],[438,33,438,96,0],[439,33,439,87,0],[439,33,439,87,0],[439,33,439,87,1],[440,33,440,133,1],[440,33,440,133,0],[440,33,440,133,0],[441,33,441,124,0],[441,33,441,124,1],[441,33,441,124,0],[442,33,442,127,0],[442,33,442,127,1],[442,33,442,127,0],[443,33,443,96,0],[443,33,443,96,1],[443,33,443,96,0],[446,33,458,35,0],[446,33,458,35,1],[446,33,458,35,0],[460,33,460,63,0],[460,33,460,63,0],[460,33,460,63,1],[461,29,461,30,1],[461,29,461,30,0],[461,29,461,30,0],[462,25,462,26,1],[462,25,462,26,0],[462,25,462,26,0],[463,21,463,22,1],[463,21,463,22,0],[463,21,463,22,0],[464,21,464,34,0],[464,21,464,34,0],[464,21,464,34,1],[465,17,465,18,0],[465,17,465,18,0],[465,17,465,18,1],[466,13,466,14,0],[466,13,466,14,1],[466,13,466,14,0],[467,13,467,33,0],[467,13,467,33,1],[467,13,467,33,0],[468,13,468,14,0],[468,13,468,14,0],[468,13,468,14,1],[469,17,469,26,0],[469,17,469,26,0],[469,17,469,26,1],[473,13,473,60,0],[473,60,473,75,0],[473,75,473,102,0],[473,102,473,121,0],[473,121,473,132,0],[473,13,473,132,0],[473,13,473,60,1],[473,60,473,75,1],[473,75,473,102,1],[473,102,473,121,1],[473,121,473,132,1],[473,13,473,132,1],[473,13,473,60,0],[473,60,473,75,0],[473,75,473,102,0],[473,102,473,121,0],[473,121,473,132,0],[473,13,473,132,0],[475,9,475,10,0],[475,9,475,10,0],[475,9,475,10,1],[479,9,479,10,0],[479,9,479,10,0],[479,9,479,10,1],[480,10,480,33,0],[480,10,480,33,0],[480,10,480,33,1],[482,10,483,193,0],[482,10,483,193,0],[482,10,483,193,1],[484,10,484,71,1],[484,10,484,71,0],[484,10,484,71,0],[485,10,485,63,1],[485,10,485,63,0],[485,10,485,63,0],[488,10,488,41,1],[488,10,488,41,0],[488,10,488,41,0],[489,10,489,11,0],[489,10,489,11,0],[489,10,489,11,0],[490,11,490,34,0],[490,11,490,34,0],[490,11,490,34,0],[491,10,491,11,0],[491,10,491,11,0],[491,10,491,11,0],[492,9,492,10,0],[492,9,492,10,1],[492,9,492,10,0],[496,9,496,10,0],[496,9,496,10,1],[496,9,496,10,0],[498,10,498,33,0],[498,10,498,33,0],[498,10,498,33,1],[500,10,501,228,1],[500,10,501,228,0],[500,10,501,228,0],[502,10,502,71,1],[502,10,502,71,0],[502,10,502,71,0],[503,10,503,63,0],[503,10,503,63,1],[503,10,503,63,0],[506,13,506,44,0],[506,13,506,44,1],[506,13,506,44,0],[506,45,506,46,0],[506,45,506,46,0],[506,45,506,46,0],[507,11,507,34,0],[507,11,507,34,0],[507,11,507,34,0],[508,10,508,11,0],[508,10,508,11,0],[508,10,508,11,0],[509,9,509,10,0],[509,9,509,10,0],[509,9,509,10,1],[513,9,513,10,0],[513,9,513,10,1],[513,9,513,10,0],[514,10,514,33,0],[514,10,514,33,1],[514,10,514,33,0],[516,10,518,136,0],[516,10,518,136,1],[516,10,518,136,0],[519,10,519,66,1],[519,10,519,66,0],[519,10,519,66,0],[520,10,520,63,1],[520,10,520,63,0],[520,10,520,63,0],[522,10,522,41,1],[522,10,522,41,0],[522,10,522,41,0],[523,10,523,11,0],[523,10,523,11,0],[523,10,523,11,0],[524,11,524,34,0],[524,11,524,34,0],[524,11,524,34,0],[525,10,525,11,0],[525,10,525,11,0],[525,10,525,11,0],[526,9,526,10,1],[526,9,526,10,0],[526,9,526,10,0],[530,9,530,10,1],[530,9,530,10,0],[530,9,530,10,0],[531,10,531,33,1],[531,10,531,33,0],[531,10,531,33,0],[533,10,534,202,1],[533,10,534,202,0],[533,10,534,202,0],[535,10,535,71,0],[535,10,535,71,1],[535,10,535,71,0],[538,10,538,41,0],[538,10,538,41,1],[538,10,538,41,0],[539,10,539,11,0],[539,10,539,11,0],[539,10,539,11,0],[540,11,540,34,0],[540,11,540,34,0],[540,11,540,34,0],[541,10,541,11,0],[541,10,541,11,0],[541,10,541,11,0],[542,9,542,10,0],[542,9,542,10,0],[542,9,542,10,1]]);
    </script>
  </body>
</html>