<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Downloads\College Work\CLASSES\Computing Capstone\CS4982CapstoneProject\code\RentMe\RentMeDesktopTests\ViewModel\BaseViewModelTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Microsoft.VisualStudio.TestTools.UnitTesting;
using RentMeDesktop.ViewModel;
using SharedCode.DAL;
using SharedCode.TestObjects;
using System;

namespace RentMeDesktopTests.ViewModel
{
	[TestClass]
	public class BaseViewModelTests
    {
		[TestMethod()]
		public void GetRentalItemsTestIsValid()
		{
			var rentalDal = new MockRentalDal
			{
				ThrowError = false
			};
			var viewModel = new BaseViewModel(rentalDal, new MockEmployeeDal());

			viewModel.GetRentalItems();

			Assert.AreEqual(1, viewModel.RentalItems.Count);
		}

		[TestMethod()]
		[ExpectedException(typeof(Exception))]
		public void GetRentalItemsTestIsInvalid()
		{
			var rentalDal = new MockRentalDal
			{
				ThrowError = true
			};
			var viewModel = new BaseViewModel(rentalDal, new MockEmployeeDal());
			viewModel.GetRentalItems();

		}

		[TestMethod()]
		public void ValidateLoginCredentialsIsValid()
		{
			var employeeDal = new MockEmployeeDal
			{
				AuthenticateValueToReturn = 1,
				ThrowError = false
			};
			var viewModel = new BaseViewModel(new RentalDal(), employeeDal);

			Assert.AreEqual(true, viewModel.ValidateLoginCredentials(&quot;user&quot;, &quot;pass&quot;));
		}

		[TestMethod()]
		[ExpectedException(typeof(Exception))]
		public void ValidateLoginCredentialsIsInvalid()
		{
			var employeeDal = new MockEmployeeDal
			{
				ThrowError = true
			};
			var viewModel = new BaseViewModel(new RentalDal(),  employeeDal);
			viewModel.ValidateLoginCredentials(&quot;user&quot;, &quot;pass&quot;);

		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,3,14,4,0],[15,4,18,6,0],[19,4,19,72,0],[21,4,21,31,0],[23,4,23,52,0],[24,3,24,4,0],[29,3,29,4,0],[30,4,33,6,0],[34,4,34,72,0],[35,4,35,31,0],[37,3,37,4,0],[41,3,41,4,0],[42,4,46,6,0],[47,4,47,68,0],[49,4,49,78,0],[50,3,50,4,0],[55,3,55,4,0],[56,4,59,6,0],[60,4,60,69,0],[61,4,61,55,0],[63,3,63,4,0]]);
    </script>
  </body>
</html>